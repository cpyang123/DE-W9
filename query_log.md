```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

```sql

    WITH mean_room_age as (
        SELECT HouseAge, AVG(AveRooms) as average_age_rooms
        FROM tbl_housing_data
        GROUP BY HouseAge
    )
    SELECT *
    FROM tbl_housing_data t1
    LEFT JOIN mean_room_age t2
    ON t1.HouseAge = t2.HouseAge
    WHERE t1.AveRooms <= average_age_rooms

```

```response from databricks
[Row(id=20, MedInc=3.0139, HouseAge=29.0, AveRooms=5.43801652892562, AveBedrms=1.0300751879699248, Population=1652.0, AveOccup=3.10377358490566, Latitude=34.13, Longitude=-117.32, MedHouseVal=0.926, HouseAge=29.0, average_age_rooms=5.43801652892562), Row(id=7, MedInc=2.3562, HouseAge=31.0, AveRooms=5.186567164179104, AveBedrms=1.154228855721393, Population=1346.0, AveOccup=3.3482587064676617, Latitude=32.68, Longitude=-117.07, MedHouseVal=0.824, HouseAge=31.0, average_age_rooms=5.186567164179104), Row(id=19, MedInc=4.1518, HouseAge=18.0, AveRooms=4.7565445026178015, AveBedrms=1.0676156583629892, Population=3055.0, AveOccup=2.2807377049180326, Latitude=34.15, Longitude=-118.43, MedHouseVal=3.433, HouseAge=18.0, average_age_rooms=6.809812593607189), Row(id=9, MedInc=5.637, HouseAge=20.0, AveRooms=4.39186295503212, AveBedrms=1.0533117932148628, Population=1634.0, AveOccup=2.6813880126182967, Latitude=33.88, Longitude=-118.36, MedHouseVal=2.291, HouseAge=20.0, average_age_rooms=4.39186295503212), Row(id=4, MedInc=3.75, HouseAge=52.0, AveRooms=4.284403669724771, AveBedrms=1.0692464358452138, Population=1793.0, AveOccup=1.6047904191616766, Latitude=37.8, Longitude=-122.41, MedHouseVal=4.5, HouseAge=52.0, average_age_rooms=4.284403669724771), Row(id=1, MedInc=3.7188, HouseAge=17.0, AveRooms=6.013372956909361, AveBedrms=1.0542168674698795, Population=1504.0, AveOccup=3.8130841121495327, Latitude=38.69, Longitude=-121.22, MedHouseVal=0.946, HouseAge=17.0, average_age_rooms=6.013372956909361), Row(id=6, MedInc=2.3654, HouseAge=21.0, AveRooms=4.734883720930233, AveBedrms=1.011395555360747, Population=1112.0, AveOccup=2.937246963562753, Latitude=35.65, Longitude=-117.64, MedHouseVal=0.811, HouseAge=21.0, average_age_rooms=4.734883720930233), Row(id=14, MedInc=1.8792, HouseAge=26.0, AveRooms=4.9833984375, AveBedrms=1.1109375, Population=1560.0, AveOccup=2.184126984126984, Latitude=36.8, Longitude=-119.8, MedHouseVal=0.771, HouseAge=26.0, average_age_rooms=5.347606612470487), Row(id=2, MedInc=4.775, HouseAge=27.0, AveRooms=6.535603715170279, AveBedrms=1.1031746031746033, Population=1061.0, AveOccup=2.464601769911815, Latitude=34.71, Longitude=-120.45, MedHouseVal=1.576, HouseAge=27.0, average_age_rooms=6.535603715170279), Row(id=13, MedInc=6.311, HouseAge=14.0, AveRooms=7.043478260869565, AveBedrms=1.0276595744680852, Population=1573.0, AveOccup=3.14341085271317, Latitude=37.21, Longitude=-121.87, MedHouseVal=2.836, HouseAge=14.0, average_age_rooms=7.043478260869565), Row(id=17, MedInc=2.7543, HouseAge=38.0, AveRooms=3.759864712514093, AveBedrms=1.0383314543404736, Population=1605.0, AveOccup=4.072153325817362, Latitude=33.97, Longitude=-118.28, MedHouseVal=1.629, HouseAge=38.0, average_age_rooms=3.759864712514093), Row(id=0, MedInc=2.3859, HouseAge=15.0, AveRooms=3.8271604938271606, AveBedrms=1.112099644128114, Population=1280.0, AveOccup=2.486988847583643, Latitude=34.6, Longitude=-120.12, MedHouseVal=0.98, HouseAge=15.0, average_age_rooms=3.8271604938271606), Row(id=21, MedInc=7.7846, HouseAge=8.0, AveRooms=6.459269662921348, AveBedrms=1.0570388349514563, Population=7249.0, AveOccup=2.858349223644784, Latitude=37.89, Longitude=-122.04, MedHouseVal=3.49, HouseAge=8.0, average_age_rooms=6.459269662921348), Row(id=8, MedInc=2.2672, HouseAge=23.0, AveRooms=4.640155210643105, AveBedrms=1.06430155210643, Population=628.0, AveOccup=1.7744610281923714, Latitude=38.53, Longitude=-121.43, MedHouseVal=0.995, HouseAge=23.0, average_age_rooms=5.825239847209458), Row(id=16, MedInc=2.375, HouseAge=44.0, AveRooms=3.8372093023255816, AveBedrms=1.069767441860465, Population=1278.0, AveOccup=4.232558139534884, Latitude=34.07, Longitude=-118.19, MedHouseVal=1.507, HouseAge=44.0, average_age_rooms=3.8372093023255816), Row(id=15, MedInc=3.2823, HouseAge=10.0, AveRooms=4.965882352941176, AveBedrms=1.0528885272579334, Population=1727.0, AveOccup=2.190812720848057, Latitude=38.03, Longitude=-122.06, MedHouseVal=2.25, HouseAge=10.0, average_age_rooms=4.965882352941176), Row(id=3, MedInc=2.4138, HouseAge=16.0, AveRooms=3.350203409090909, AveBedrms=0.965432098765432, Population=1255.0, AveOccup=2.0892857142857144, Latitude=32.66, Longitude=-117.09, MedHouseVal=1.336, HouseAge=16.0, average_age_rooms=4.589199878061436), Row(id=10, MedInc=2.6058, HouseAge=26.0, AveRooms=4.295049504950495, AveBedrms=1.0242424242424242, Population=1667.0, AveOccup=4.287313432835821, Latitude=34.04, Longitude=-117.74, MedHouseVal=1.393, HouseAge=26.0, average_age_rooms=5.347606612470487)]
```

